// Title: Potentially Suspicious Malware Callback Communication in Linux devices
// Description: Detects potentially suspicious malware callback communication in Linux devices 
// Mitre: T1043
// Mitre tactic: Exfiltration
// Reference: https://attack.mitre.org/techniques/T1043/
Syslog 
| where ((syslog_message =~ @'true' 
     and syslog_message in (888, 999, 2200, 2222, 4000, 4444, 6789, 8531, 50501, 51820)) 
     and not ((syslog_message contains @'127.0.0.0/8' 
     or syslog_message contains @'10.0.0.0/8' 
     or syslog_message contains @'172.16.0.0/12' 
     or syslog_message contains @'192.168.0.0/16' 
     or syslog_message contains @'169.254.0.0/16' 
     or syslog_message contains @'::1/128' 
     or syslog_message contains @'fe80::/10' 
     or syslog_message contains @'fc00::/7')))
//| extend Description = "Detects potentially suspicious malware callback communication in Linux devices"
| project Timestamp, Computer, Description, syslog_message